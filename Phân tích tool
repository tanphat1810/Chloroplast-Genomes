## 🔧 GetOrganelle vs NOVOPlasty — mục đích & khi nào dùng

| Công cụ        | Đặc điểm chính                                                                                   | Khi nên dùng |
|---|---|---|
| **GetOrganelle** | Thuật toán graph-based (SPAdes) + seed; tự nhận diện cpDNA; kết quả rất **chính xác** và **hoàn chỉnh** | ✅ Dữ liệu tốt, đủ coverage; cần genome trọn vẹn (đầy đủ LSC–IR–SSC, không gap) |
| **NOVOPlasty**  | Cần chỉ định **seed sequence** (vd. *rbcL*, *matK*); lắp ráp theo hướng kéo dài từ seed         | 🔄 Khi GetOrganelle không ra vòng hoàn chỉnh hoặc gặp lỗi |

> **Lưu ý:** Nếu GetOrganelle cho kết quả “vòng tròn hoàn chỉnh, không gap”, thường **không cần** chạy NOVOPlasty.

---

## 🧽 NextPolish (tùy chọn)

- **Mục đích:** Polishing sau lắp ráp để sửa lỗi base nhỏ bằng cách map lại Illumina reads.
- **Input:** Genome lắp ráp (*.fasta*) + Illumina reads.
- **Output:** Bản genome tinh chỉnh, chính xác hơn.
- **Gợi ý:** Nếu kiểm tra (vd. trong Geneious) không thấy mismatch và genome đã tròn, có thể **bỏ qua** bước này.

---

## 🧭 Annotation: GeSeq (có thể thay thế PGA)

- **Chức năng:** Chú giải gen/tRNA/rRNA, xác định vùng IR, vẽ bản đồ bằng **OGDRAW**.
- **Giao diện web:** https://chlorobox.mpimp-golm.mpg.de/geseq.html  
- **Đầu ra:** *.gb* / *.gff* — có thể dùng để nộp GenBank.

---

## ♻️ Structural & Repeat Analysis

### Tandem Repeats Finder (TRF) v4.09
- **Mục đích:** Phát hiện lặp liên tiếp (microsatellite SSR, minisatellite), ví dụ (AAT)ₙ, (ATC)ₙ, (GAA)ₙ.
- **Input:** *.fasta* cp-genome → **Output:** *.dat* (vị trí, độ dài, loại repeat).
- **Ý nghĩa:** Xác định vùng biến động/tiềm năng chỉ thị di truyền.

### RepeatMasker v1.317 + `auto_repeat.pl`
- **Mục đích:** Nhận diện & phân loại **Transposable Elements (TEs)**: DNA transposon, **LINE**, **SINE**, **LTR**.
- **Ghi chú:** Chạy RepeatMasker với thông số mặc định; dùng `auto_repeat.pl` (Zhou He-ling, BGI) để gom nhóm TE và tạo bảng thống kê theo 4 lớp lớn (DNA, LINE, SINE, LTR).

### IR/LSC/SSC & IR boundary
- **Quan sát:** Co/giãn IR và ranh giới LSC/IRb/SSC/IRa.
- **Công cụ gợi ý:** **IRscope** (tùy chọn) để trực quan ranh giới IR.

**Đầu ra mong đợi:** Bản đồ repeat, thống kê TE, và hình ranh giới IR (IR boundary) để so sánh cấu trúc.

---

## 🧬 Comparative Genomics — mVISTA (shuffle-LAGAN)

- **Mục đích:** So sánh mức độ tương đồng toàn genome; tìm **hotspots** biến đổi và vùng bảo tồn.
- **Nguyên lý:** Căn chỉnh whole-genome; chế độ **shuffle-LAGAN** phù hợp cpDNA có synteny bảo tồn.
- **Input:** FASTA/GenBank ≥2 genome; chọn 1 genome tham chiếu.
- **Output:** Biểu đồ phần trăm tương đồng theo vùng **LSC–IR–SSC**.
- **Web:** https://genome.lbl.gov/vista/mvista/submit.shtml  
- **Trích dẫn:** Frazer et al., 2004 (NAR 32: W273–W279).

---

## 🧪 CodonW — Codon Usage Bias

- **Mục tiêu:** Đánh giá **codon usage bias** & thành phần GC.
- **Chỉ số:** **CAI**, **CBI**, **Fop**, **ENc**, **GC3s**, **RSCU**.
- **Input:** FASTA các **CDS** (trích từ GeSeq/PGA); **Output:** Bảng chỉ số (per-gene / genome-level) → vẽ **ENc–GC3s plot**, **RSCU plot**.
- **Trích dẫn:** Peden, 1999 (PhD Thesis).

---

## 🧩 Align cho dN/dS & Positive Selection

### PRANK v.170427
- **Mục đích:** Multiple sequence alignment theo **codon**, xử lý indel tốt — phù hợp trước bước dN/dS.
- **Input/Output:** FASTA các gen ortholog → *.aln*/*.phy*.
- **Trích dẫn:** Löytynoja & Goldman, 2005 (PNAS 102:10557–10562).

### KaKs_Calculator
- **Mục đích:** Tính **Ka, Ks, Ka/Ks** (dN/dS) giữa các trình tự.
- **Dien giải:** Ka/Ks < 1 (purifying), =1 (neutral), >1 (positive).
- **Trích dẫn:** Zhang et al., 2006 (GPB 4:259–263).

### PAML (codeml)
- **Mục đích:** Kiểm định **chọn lọc dương** bằng mô hình codon (site / branch-site).
- **Quy trình:** So sánh M7 vs M8; test χ²; báo cáo vị trí/gen có ω>1, *p*<0.05.
- **Input:** Align *.phy* + cây tiến hóa; file cấu hình **codeml.ctl**.
- **Trích dẫn:** Yang, 2007 (MBE 24:1586–1591).

---

## 🌳 Chuẩn bị dữ liệu cây phát sinh chủng loại

- **Chọn gen single-copy** xuất hiện ở tất cả loài.
- **Căn chỉnh** (PRANK/MAFFT) → **Concatenate** thành supermatrix (vd. `catfasta2phyml.pl`).
- **Output:** *.phy/*fasta concatenated cho các bộ dựng cây.

### MrBayes v3.2.2 (BI)
- **Output:** `*.con.tre` + posterior probability (PP).
- **Trích dẫn:** Ronquist et al., 2012 (Syst Biol 61:539–542).

### PhyML v3.0 (ML)
- **Output:** `*.phy_phyml_tree.txt` + **bootstrap** (%).
- **Trích dẫn:** Guindon et al., 2010 (Syst Biol 59:307–321).

### TreeBeST v1.9.2 (NJ)
- **Output:** *.nwk tree — dùng đối chiếu với BI/ML.
- **Trích dẫn:** Vilella et al., 2009 (Genome Res 19:327–335).

**Bootstrap & đánh giá nhánh**
- Lặp 100 lần (bootstrap = 100) cho ML/NJ; BI dùng **PP** thay thế bootstrap.

---

## 🧾 Sequence Divergence & DNA Barcoding

### MUSCLE
- **Mục đích:** MSA cho các gen/rEG intergenic (vd. *matK*, *rbcL*, *ycf1*, *trnH–psbA*).
- **Trích dẫn:** Edgar, 2004 (NAR 32:1792–1797).

### MEGA7 & K2P
- **Mục đích:** Tính **p-distance** (K2P) giữa loài; chọn marker có độ phân giải cao.
- **Thao tác:** *Compute → Estimate Evolutionary Distances → Kimura 2-parameter*.
- **Trích dẫn:** Kumar et al., 2016 (MBE 33:1870–1874); Kimura, 1980 (JME 16:111–120).

### Chọn gen barcode ứng viên
- So sánh **p-distance** trung bình giữa các gen; ưu tiên gen **biến động cao** và **ít missing**.  
- Ứng viên thường gặp: **ycf1, matK, rbcL, trnH–psbA**.  
- Có thể trực quan hóa bằng barplot (R/Excel).

